/u/ssoma1/.local/lib/python3.9/site-packages/networkx/utils/backends.py:135: RuntimeWarning: networkx backend defined more than once: nx-loopback
  backends.update(_get_backends("networkx.backends"))
Traceback (most recent call last):
  File "/u/ssoma1/mahdi/Isomorphic-Pruning/prune.py", line 296, in <module>
    main()
  File "/u/ssoma1/mahdi/Isomorphic-Pruning/prune.py", line 136, in main
    base_macs, base_params = tp.utils.count_ops_and_params(model, example_inputs)
  File "/u/ssoma1/.local/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/u/ssoma1/.local/lib/python3.9/site-packages/torch_pruning/utils/op_counter.py", line 35, in count_ops_and_params
    _ = flops_model(example_inputs)
  File "/u/ssoma1/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/u/ssoma1/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1857, in _call_impl
    return inner()
  File "/u/ssoma1/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1805, in inner
    result = forward_call(*args, **kwargs)
  File "/u/ssoma1/.local/lib/python3.9/site-packages/timm/models/vision_transformer.py", line 465, in forward
    x = self.forward_features(x)
  File "/u/ssoma1/.local/lib/python3.9/site-packages/timm/models/deit.py", line 160, in forward_features
    x = self.blocks(x)
  File "/u/ssoma1/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/u/ssoma1/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/u/ssoma1/.local/lib/python3.9/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
  File "/u/ssoma1/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/u/ssoma1/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/u/ssoma1/.local/lib/python3.9/site-packages/timm/models/vision_transformer.py", line 242, in forward
    x = x + self.drop_path1(self.ls1(self.attn(self.norm1(x))))
  File "/u/ssoma1/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/u/ssoma1/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1857, in _call_impl
    return inner()
  File "/u/ssoma1/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1805, in inner
    result = forward_call(*args, **kwargs)
  File "/u/ssoma1/mahdi/Isomorphic-Pruning/pbench/forward_patch.py", line 11, in forward
    qkv = self.qkv(x).reshape(B, N, 3, self.num_heads, self.head_dim).permute(2, 0, 3, 1, 4)
  File "/u/ssoma1/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'Attention' object has no attribute 'head_dim'
